<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>Tag: C++ | 光影星辰</title>
  
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="google-site-verification" content="PYt_hX2VWBnIOCJzFpeDmfZ3TCR92Zl7WTDgPfeTpDc">
  <meta name="baidu-site-verification" content="NX7WPDjsb1">
  <!-- meta -->
  
  
  <meta name="theme-color" content="#FFFFFF">
  <meta name="msapplication-TileColor" content="#1BC3FB">
  <meta name="msapplication-config" content="https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicons/browserconfig.xml">
  

  <!-- link -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css">
  
  
  <link rel="shortcut icon" type="image/x-icon" href="https://raw.githubusercontent.com/calm2012/file_storage/master/image/apple.ico">
  <link rel="icon" type="image/x-icon" sizes="32x32" href="https://raw.githubusercontent.com/calm2012/file_storage/master/image/apple.ico">
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://raw.githubusercontent.com/calm2012/file_storage/master/image/apple.ico">
  <link rel="mask-icon" color="#1BC3FB" href="https://raw.githubusercontent.com/calm2012/file_storage/master/image/apple.ico">
  <link rel="manifest" href="https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/favicon/favicons/site.webmanifest">
  

  

  
  <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'PYt_hX2VWBnIOCJzFpeDmfZ3TCR92Zl7WTDgPfeTpDc', 'calm2012.github.io');
      ga('send', 'pageview');
    </script>
  
  
    <!-- ba -->
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?1c9bd0bcc92aed38d85380f859e7f47e";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
  
</head>

<body>
    <div id="loading-bar-wrapper">
  <div id="loading-bar" class="pure"></div>
</div>

    <script>setLoadingBarProgress(20)</script>
    <header class="l_header pure">
	<div class="wrapper">
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href="/">
        
          光影星辰
        
      </a>
			<div class="menu">
				<ul class="h-list">
          
  					
  						<li>
								<a id="home" class="nav flat-box" href="/">
									<i class="fas fa-home fa-fw"></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a id="categories" class="nav flat-box" href="/categories/">
									<i class="fas fa-folder-open fa-fw"></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a id="tags" class="nav flat-box" href="/tags/">
									<i class="fas fa-hashtag fa-fw"></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a id="archives" class="nav flat-box" href="/archives/">
									<i class="fas fa-archive fa-fw"></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a id="about" class="nav flat-box" href="/about/">
									<i class="fas fa-user fa-fw"></i>&nbsp;关于
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索">
						<span class="icon"><i class="fas fa-search fa-fw"></i></span>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li>
				
				<li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>

		<div class="nav-sub container container--flex">
			<a class="logo flat-box"></a>
			<ul class="switcher h-list">
				<li class="s-comment"><a class="flat-btn fas fa-comments fa-fw" href="javascript:void(0)"></a></li>
				<li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu">
      <ul>
          
              
                  <li>
										<a id="home" class="nav flat-box" href="/">
											<i class="fas fa-home fa-fw"></i>&nbsp;主页
										</a>
                  </li>
              
                  <li>
										<a id="categories" class="nav flat-box" href="/categories/">
											<i class="fas fa-folder-open fa-fw"></i>&nbsp;分类
										</a>
                  </li>
              
                  <li>
										<a id="tags" class="nav flat-box" href="/tags/">
											<i class="fas fa-hashtag fa-fw"></i>&nbsp;标签
										</a>
                  </li>
              
                  <li>
										<a id="archives" class="nav flat-box" href="/archives/">
											<i class="fas fa-archive fa-fw"></i>&nbsp;归档
										</a>
                  </li>
              
                  <li>
										<a id="about" class="nav flat-box" href="/about/">
											<i class="fas fa-user fa-fw"></i>&nbsp;关于
										</a>
                  </li>
              
       
      </ul>
		</nav>
    </header>
	</aside>

    <script>setLoadingBarProgress(40);</script>
    <div class="l_body">
    <div class='container clearfix'>
        <div class='l_main'>
            
    <script>
        window.subData= { title:'标签 : C++'}
    </script>




  <section class="post-list">
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      



      

      

      
        
          
            <div class="post-wrapper">
              <article class="post reveal ">
    
<section class="meta">
  
  
  <div class="meta" id="header-meta">
    
      <h2 class="title">
          <a href="/C++从入门到实践，你不得不知道的事一：C++函数的一些底层细节/">
              
                  C++深入浅出之：C++函数的一些底层细节
              
          </a>
      </h2>
    

    <div class="new-meta-box">
      
        <div class="new-meta-item author">
          <a href="https://calm2012.github.io/calm2012.github.io">
            <i class="fas fa-user" aria-hidden="true"></i>
            calm2012
          </a>
        </div>
      
      
        <div class="new-meta-item date">
          <a class="notlink">
            <i class="fas fa-clock" aria-hidden="true"></i>
            2023-02-24 星期五
          </a>
        </div>
      
      
        
          
          <div class="new-meta-item category">
            <a href="/categories/C/C-深入浅出之：C-函数的一些底层细节/">
              <i class="fas fa-folder-open" aria-hidden="true"></i>
              C++&nbsp;/&nbsp;C++深入浅出之：C++函数的一些底层细节
            </a>
          </div>
        
      
      
      
    </div>
    <hr>
  </div>
</section>

    <section class="article typo">
        <p>可能我们平时有过以下疑问：</p>
<blockquote>
<ol>
<li>C++函数和C函数有区别吗？</li>
<li>C函数的调用过程是什么样的？</li>
<li>C++函数的调用过程是什么样的？</li>
<li>类似 int sum(int, int)这样的函数，可以被正常调用并返回期望的结果吗？</li>
<li>Obj* obj = nullptr; obj-&gt;show(); obj-&gt;get_name();可以编译通过吗？如果可以，运行后会显示什么？</li>
<li>std::function、std::bind、lambda底层是怎么实现的？</li>
</ol>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Obj</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Obj::show"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">get_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"obj"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    Obj* obj = <span class="literal">nullptr</span>;</span><br><span class="line">    obj-&gt;show();</span><br><span class="line">    obj-&gt;get_name();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>后续示例代码编译环境:</p>
<blockquote>
<ul>
<li>操作系统：Windows7及以上（推荐Windows11）</li>
<li>编译器：Visual Studio 2010及以上（推荐Visual Studio 2022）</li>
<li>编译选项：x86 debug版本</li>
<li>IDA反汇编工具</li>
<li>一个在线把C++翻译成汇编的网址：<a href="https://godbolt.org" target="_blank" rel="noopener">https://godbolt.org</a><br>没有Windows环境的，也可以借助这个网站来模拟学习，选择x86 msvc v19.lastest</li>
</ul>
</blockquote>
<p>本文涉及到的知识点包括：</p>
<blockquote>
<ul>
<li>C++</li>
<li>x86汇编</li>
<li>栈平衡</li>
<li>软件安全（缓冲区溢出攻击）</li>
</ul>
</blockquote>
<p><strong>本文将从编译器的视角分析编译的C++程序。简单的通过利用调试器、调试器里的反汇编功能，来提供一种剖析C++的底层原理的思路，从而帮我们深入理解C++。</strong><br>文中涉及到的示例代码均可在推荐的开发环境中编译和运行。</p>
<hr>
<h3 id="在分析开篇的那几个问题前，我们先看一个函数的调用过程"><a href="#在分析开篇的那几个问题前，我们先看一个函数的调用过程" class="headerlink" title="在分析开篇的那几个问题前，我们先看一个函数的调用过程"></a>在分析开篇的那几个问题前，我们先看一个函数的调用过程</h3><p>为此，我们采用一段简单的C++代码来说明：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo1.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num1 = sum(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>假设我们猜测<code>int num = add(1, 2);</code>调用过程如下：（当然也可以跳过假设直接查看反编译代码）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__asm &#123;</span><br><span class="line">    pushad                  // 保存寄存器当前存储的值</span><br><span class="line">    push 2                  // 把sum(1, 2); 中的参数2压栈</span><br><span class="line">    push 1                  // 把sum(1, 2); 中的参数1压栈</span><br><span class="line">    call sum                // 调用sum函数</span><br><span class="line">    add esp, 8              // 手动做栈平衡（如果把这行注释掉，栈就不平衡了，程序直接崩溃，可自行测试）</span><br><span class="line">    mov num1, eax           // 把sum函数的执行结果，赋值给变量num1</span><br><span class="line">    popad                   // 恢复寄存器数值，恢复为pushad保存的数值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>一些关于汇编的参考资料：<br>x86汇编指令集大全：<a href="https://zhuanlan.zhihu.com/p/53394807" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/53394807</a><br>机械指令 对应 汇编指令：<a href="https://blog.csdn.net/jzxin0/article/details/106069838" target="_blank" rel="noopener">https://blog.csdn.net/jzxin0/article/details/106069838</a><br>那么写一段完整代码来验证：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo1.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num1 = sum(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> num2 = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// int num2 = sum(1, 2);函数调用过程，在编译器看来是等效于如下过程：</span></span><br><span class="line">    __asm &#123;</span><br><span class="line">        pushad                  <span class="comment">// 保存寄存器当前存储的值</span></span><br><span class="line">        push <span class="number">2</span>                  <span class="comment">// 把sum(1, 2); 中的参数2压栈</span></span><br><span class="line">        push <span class="number">1</span>                  <span class="comment">// 把sum(1, 2); 中的参数1压栈</span></span><br><span class="line">        call sum                <span class="comment">// 调用函数sum</span></span><br><span class="line">        add esp, <span class="number">8</span>              <span class="comment">// 手动做栈平衡</span></span><br><span class="line">        mov num2, eax           <span class="comment">// 把sum的执行结果，赋值给变量num2</span></span><br><span class="line">        popad                   <span class="comment">// 恢复寄存器原来的数值，恢复为pushad保存前的数值</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上述代码运行结果如下：<br><img src="./image/00.png" alt=""><br>从执行结果来看，num1的值等于3，num2的值等于3，num1等于num2，也就是说这段内联汇编等效直接调用函数。由此我们可以猜测：<br><strong>函数调用过程：在调用一个__cdecl调用约定的函数前，首先保护当前寄存器的数值，接着是参数入栈，然后调再用该函数，调用结束后接着做栈平衡，最后再恢复寄存的值为函数调用前的值。</strong><br>那么我们如何验证我们猜测呢？<br>我们可以借助调试器的反汇编功能，在调用函数前设置一个断点，然后运行程序，等程序在断点处停下来后，点击鼠标右键选择<code>转到反汇编</code><br><img src="./image/01.png" alt=""><br>然后我们可以看到：<br><img src="./image/02.png" alt=""><br>可以看到反汇编代码和我们编写的内联汇编代码思想一致，也就证明了我们上述结论是正确的。</p>
<p>这里我们在发散一下：<br>我知道CPU只能识别机器指令（0和1排列组合）。同时一个汇编指令对应一个机器指令，<strong>有没有一种可能让CPU直接执行我们写的0和1机器语言代码呢？</strong> 想起来还有点小激动。<br>为此我们需要补充一些汇编指令对应到机器码的知识，终于在学习若干小时候后（直接快进），我们得到如下代码：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo2.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num1 = sum(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> num2 = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// int num2 = sum(1, 2);函数调用过程，在编译器看来是等效于如下过程：</span></span><br><span class="line">    __asm &#123;</span><br><span class="line">        pushad                  <span class="comment">// 保存寄存器当前存储的值</span></span><br><span class="line">        push <span class="number">2</span>                  <span class="comment">// 把sum(1, 2); 中的参数2压栈</span></span><br><span class="line">        push <span class="number">1</span>                  <span class="comment">// 把sum(1, 2); 中的参数1压栈</span></span><br><span class="line">        call sum                <span class="comment">// 调用函数sum</span></span><br><span class="line">        add esp, <span class="number">8</span>              <span class="comment">// 手动做栈平衡</span></span><br><span class="line">        mov num2, eax           <span class="comment">// 把sum的执行结果，赋值给变量num2</span></span><br><span class="line">        popad                   <span class="comment">// 恢复寄存器原来的数值，恢复为pushad保存前的数值</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    __asm &#123;</span><br><span class="line">        push ebx</span><br><span class="line">        lea ebx, sum</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 下边的数组shell_code中的代码等效于int num2 = sum(1, 3);</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> shell_code[] &#123;</span><br><span class="line">        <span class="number">0x60</span>,                   <span class="comment">// pushad</span></span><br><span class="line">        <span class="number">0x6A</span>, <span class="number">3</span>,                <span class="comment">// push 3</span></span><br><span class="line">        <span class="number">0x6A</span>, <span class="number">1</span>,                <span class="comment">// push 1</span></span><br><span class="line">        <span class="number">0xFF</span>, <span class="number">0xD3</span>,             <span class="comment">// call ebx(因为ebx存储的值是sum)</span></span><br><span class="line">        <span class="number">0x83</span>, <span class="number">0xC4</span>, <span class="number">8</span>,          <span class="comment">// add esp, 8</span></span><br><span class="line">        <span class="number">0x89</span>, <span class="number">0x45</span>, <span class="number">0xE8</span>,       <span class="comment">// mov num2, eax</span></span><br><span class="line">        <span class="number">0x61</span>,                   <span class="comment">// popad</span></span><br><span class="line">        <span class="number">0xFF</span>, <span class="number">0xE1</span>,             <span class="comment">// jmp ecx(因为ecx存储的值是end_tag, 等效与jmp end_tag)</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 修改数组shell_code这段内存为可读可写可执行</span></span><br><span class="line">    DWORD oldProtect = <span class="number">0</span>;</span><br><span class="line">    VirtualProtect(shell_code, <span class="keyword">sizeof</span>(shell_code), PAGE_EXECUTE_READWRITE, &amp;oldProtect);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 我们直接让CPU执行数组shell_code中的内容</span></span><br><span class="line">    __asm &#123;</span><br><span class="line">        pushad                 <span class="comment">// 保存寄存器当前存储的值</span></span><br><span class="line">        lea eax, shell_code    <span class="comment">// 把数组shell_code的地址放入eax</span></span><br><span class="line">        lea ecx, end_tag       <span class="comment">// 把end_tag地址放入ecx</span></span><br><span class="line">        jmp eax                <span class="comment">// 跳转到数组shell_code的首地址</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">end_tag:</span><br><span class="line">    __asm &#123;</span><br><span class="line">        popad                 <span class="comment">// 恢复寄存器原来的数值，恢复为pushad保存前的数值</span></span><br><span class="line">        pop ebx;              <span class="comment">// 恢复ebx寄存器原来的数值</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上述代码执行结果如下：<br><img src="./image/03.png" alt=""><br>到此我们应该庆祝一下，现在我们已经掌握了让CPU直接执行0、1代码的方法。<br>但也别高兴的太早，似乎软件安全面临挑战，既然我们可以执行一段由0、1组成的shellcode buffer，那么不法分子也一样可以。如果我们代码有strycpy等类似函数，又没有对输入长度做检查，亦或memcpy(a,b,n)将b中的n个字符拷贝到a处。但是如果 n&gt;a，那么都会存在缓冲区溢出攻击风险。只要不法分子精心构建一段由0、1组成的shellcode，那么我们软件、甚至整个操作系统都有可能受到威胁。<br>有兴趣进一步了解缓冲区溢出攻击的可以自行百度，或者参考文章 <a href="https://zhuanlan.zhihu.com/p/32473371" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/32473371</a> 里的思路。</p>
<h2 id="1-C-函数和C函数有区别吗？"><a href="#1-C-函数和C函数有区别吗？" class="headerlink" title="1. C++函数和C函数有区别吗？"></a>1. C++函数和C函数有区别吗？</h2><h3 id="1-1-C-类成员函数与C函数调用约定不同"><a href="#1-1-C-类成员函数与C函数调用约定不同" class="headerlink" title="1.1 C++类成员函数与C函数调用约定不同"></a>1.1 C++类成员函数与C函数调用约定不同</h3><p>首先我们大家一起回顾一下常见的函数调用约定。<br>|调用方式|参数入栈顺序|局部变量清理由谁清理|<br>|:-:|:-:|:-:|<br>|<strong>pascal|从左到右|函数内部清除（由编译器帮忙实现）|<br>|</strong>cdecl|从右到左|函数外部清除（由编译器帮忙实现）|<br>|<strong>fastcall|从右到左|函数内部清除（由编译器帮忙实现）|<br>|</strong>thiscall|从右到左|函数内部清除（由编译器帮忙实现）|<br>|__stdcall|从右到左|函数内部清除（由编译器帮忙实现）|</p>
<p>其他非常见：<br><strong>nakedcall：一般出现在汇编中，编译器不会给这种函数增加初始化和清理代码。
</strong>vectorcall：尽可能利用寄存器来传递函数的参数变量，<strong>vectorcall对寄存器的使用数目多于</strong>fastcall。</p>
<p><code>__pascal</code>: 是Pascal语言的函数调用方式，其特点是函数参数是从左到右的压栈方式入栈，局部变量在函数内部清除。（在windows下<strong>pascal已经不被msvc编译器所支持，PASCAL实际被编译器替换成了</strong>stdcall）<br><code>__cdecl</code>：是C和C++程序普通函数的缺省调用方式，其特点是函数参数是从右到左的压栈方式入栈，局部变量在函数外部清除。<br><code>__fastcall</code>：调用速度快，前两个（或若干个）参数由寄存器传递，其余参数还是通过堆栈传递。函数参数从右到左的压栈方式入栈，局部变量在函数内部清除。<br><code>__thiscall</code>：是C++类成员函数的调用方式，其特点是this指针被放在特定寄存器中（VC使用ecx），函数参数从右到左的压栈方式入栈，最后一个入栈的是this指，局部变量在函数内部清除.<br><code>__stdcall</code>：其特点函数参数从右到左的压栈方式入栈，局部变量在函数内部清除。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo10.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_def_call</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在windows下__pascal已经不被msvc编译器所支持，PASCAL实际被编译器替换成了__stdcall</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> PASCAL <span class="title">sum_PASCAL</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sum_cdecl</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">sum_fastcall</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Obj</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> __<span class="function">thiscall <span class="title">sum_thiscall</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> __<span class="function">stdcall <span class="title">sum_stdcall</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num1 = sum_def_call(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> num2 = sum_PASCAL(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> num3 = sum_cdecl(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> num4 = sum_fastcall(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> num5 = Obj().sum_thiscall(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> num6 = sum_stdcall(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num5 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num6 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的反汇编代码：<br><img src="./image/09.png" alt=""></p>
<p><strong>如果如果入栈参数所占用栈内存，不清理会怎么样？</strong><br>会破坏栈平衡，可能会导致程序直接崩溃。</p>
<h3 id="1-2-C-支持函数重载"><a href="#1-2-C-支持函数重载" class="headerlink" title="1.2 C++支持函数重载"></a>1.2 C++支持函数重载</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo3.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sum</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    sum(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    sum(<span class="number">1.0</span>, <span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过IDA，打开编译好的二进制文件，我可以看到：<br><img src="./image/04.png" alt=""><br>sum函数名，被编译器改为了j<em>?sum@@YAHHH@Z和j</em>?sum@@YANNN@Z，C++从而支持了函数重载。</p>
<h3 id="1-3-C-支持默认参数"><a href="#1-3-C-支持默认参数" class="headerlink" title="1.3 C++支持默认参数"></a>1.3 C++支持默认参数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo4.c</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码demo4.c后缀为.C，启动编译编译，构建结果：<br><img src="./image/05.png" alt=""><br>构建失败，说明C语言不支持默认参数。</p>
<h3 id="1-4-C-支持仿函数"><a href="#1-4-C-支持仿函数" class="headerlink" title="1.4 C++支持仿函数"></a>1.4 C++支持仿函数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo5.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PeoPle</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (name == <span class="string">"xiao_ming"</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">18</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (name == <span class="string">"xiao_hua"</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    PeoPle year;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> y1 = year(<span class="string">"xiao_ming"</span>);  <span class="comment">// 通过operator()，使用起来像一个函数一样</span></span><br><span class="line">    <span class="keyword">int</span> y2 = year(<span class="string">"xiao_hua"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; y1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; y2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-5-C-支持std-function"><a href="#1-5-C-支持std-function" class="headerlink" title="1.5 C++支持std::function"></a>1.5 C++支持std::function</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo6.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>, <span class="keyword">int</span>)&gt; sum1 = sum;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sum1(<span class="number">1</span>, <span class="number">2</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="./image/10.png" alt=""><br>可以看到std::function通过std::function类中operator()操作符重载实现。（当然也可以直接std::function源码来学习具体实现）</p>
<h3 id="1-6-C-支持std-bind"><a href="#1-6-C-支持std-bind" class="headerlink" title="1.6 C++支持std::bind"></a>1.6 C++支持std::bind</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo6.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>, <span class="keyword">int</span>)&gt; sum1 = sum;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sum1(<span class="number">1</span>, <span class="number">2</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> sum2 = <span class="built_in">std</span>::bind(sum, <span class="built_in">std</span>::placeholders::_1, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sum2(<span class="number">2</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="./image/11.png" alt=""><br>可以看到std::bind通过std::bind类中operator()操作符重载实现。（当然也可以直接查看std::bind源码来学习具体实现）</p>
<h3 id="1-7-C-支持lambda表达式"><a href="#1-7-C-支持lambda表达式" class="headerlink" title="1.7 C++支持lambda表达式"></a>1.7 C++支持lambda表达式</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo6.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>, <span class="keyword">int</span>)&gt; sum1 = sum;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sum1(<span class="number">1</span>, <span class="number">2</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> sum2 = <span class="built_in">std</span>::bind(sum, <span class="built_in">std</span>::placeholders::_1, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sum2(<span class="number">2</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> sum3 = [](<span class="keyword">int</span> a, <span class="keyword">int</span> b) -&gt; <span class="keyword">int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sum3(<span class="number">3</span>, <span class="number">4</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="./image/12.png" alt=""><br>可以看到lambda表达式是通过匿名类，并且operator()操作符重载实现的。</p>
<h2 id="2-C函数的调用过程是什么样的？"><a href="#2-C函数的调用过程是什么样的？" class="headerlink" title="2. C函数的调用过程是什么样的？"></a>2. C函数的调用过程是什么样的？</h2><p>首先保护当前寄存器的数值，接着是参数入栈，然后调再用该函数，调用结束后接着做栈平衡，最后再恢复寄存的值为函数调用前的值。</p>
<h2 id="3-C-函数的调用过程是什么样的？"><a href="#3-C-函数的调用过程是什么样的？" class="headerlink" title="3. C++函数的调用过程是什么样的？"></a>3. C++函数的调用过程是什么样的？</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo7.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Obj</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = Obj().sum(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>查看反汇编：<br><img src="./image/06.png" alt=""><br>由此可以知：<br>C++普通函数调用过程和C函数是一样，C++类成员函数，调用过程和C函数类似，只是编译器把this指针存入了ecx（msvc编译器是这样，不同编译器可能用不同的寄存器。）</p>
<h2 id="4-类似-int-sum-int-int-这样的函数，可以被正常调用并返回期望的结果吗？"><a href="#4-类似-int-sum-int-int-这样的函数，可以被正常调用并返回期望的结果吗？" class="headerlink" title="4. 类似 int sum(int, int)这样的函数，可以被正常调用并返回期望的结果吗？"></a>4. 类似 int sum(int, int)这样的函数，可以被正常调用并返回期望的结果吗？</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo8.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> <span class="comment">/*a*/</span>, <span class="keyword">int</span> <span class="comment">/*b*/</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>* base = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">int</span>* a = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">int</span>* b = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    __asm &#123;</span><br><span class="line">        mov base, ebp</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    a = (base + <span class="number">2</span>) + <span class="number">1</span>;  <span class="comment">// call sum有1次push，sum头，push esp，也有1此push，所以要跳过这2个数值，到存放a, b栈地址。</span></span><br><span class="line">    b = (base + <span class="number">2</span>) + <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> *a + *b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// call指令等效于先push xx, 在jmp xx</span></span><br><span class="line">    <span class="keyword">int</span> num  = sum(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行上边代码：<br><img src="./image/07.png" alt=""><br>由此可知，我们可以通过寄存器esp指向的堆栈，直接拿到想要的参数变量的值，类似 int add(int, int)这种函数也就可以正常工作了。（因为函数来说，无论参数变量有无名称，最终都会被放到栈上，那么我们就有办法直接从栈上取到参数对应的变量）</p>
<h3 id="Obj-obj-nullptr-obj-gt-show-obj-gt-get-name-可以编译通过吗？如果可以，运行后会显示什么？"><a href="#Obj-obj-nullptr-obj-gt-show-obj-gt-get-name-可以编译通过吗？如果可以，运行后会显示什么？" class="headerlink" title="Obj* obj = nullptr; obj-&gt;show(); obj-&gt;get_name();可以编译通过吗？如果可以，运行后会显示什么？"></a>Obj* obj = nullptr; obj-&gt;show(); obj-&gt;get_name();可以编译通过吗？如果可以，运行后会显示什么？</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Obj</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Obj::show"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">get_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"obj"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    Obj* obj = <span class="literal">nullptr</span>;</span><br><span class="line">    obj-&gt;show();</span><br><span class="line">    obj-&gt;get_name();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行上述代码：<br><img src="./image/08.png" alt=""><br>obj-&gt;show();是可以调用的，show()属于类，不管有没有类实例，show()都是存在的（被所有类实例共享）。<br>obj-&gt;get_name();由于需要先找到虚表，再从虚表找到get_name()函数的地址，虚表放在obj的首地址，而obj值是nullptr，程序崩溃</p>
<p><strong>最后，只要我们要学会了善于利用调试器，以及调试器里边的反汇编功能，假以时日，那些看似遥不可及的C++底层原理，也必然为我们所用！</strong></p>
<hr>
<p>一些题外话：<br>当下还有什么工程用到了汇编么吗？<br>1.Linux内核：<a href="https://github.com/torvalds/linux/blob/master/arch/x86/boot/copy.S" target="_blank" rel="noopener">https://github.com/torvalds/linux/blob/master/arch/x86/boot/copy.S</a><br>2.FFmpeg多媒体框架：<a href="https://github.com/FFmpeg/FFmpeg/tree/master/libavutil/x86" target="_blank" rel="noopener">https://github.com/FFmpeg/FFmpeg/tree/master/libavutil/x86</a><br>3.OpenSSL加密库：<a href="https://github.com/openssl/openssl/tree/master/crypto/x86" target="_blank" rel="noopener">https://github.com/openssl/openssl/tree/master/crypto/x86</a><br>4.GCC编译器：<a href="https://github.com/gcc-mirror/gcc/blob/master/gcc/config/i386/i386.cc" target="_blank" rel="noopener">https://github.com/gcc-mirror/gcc/blob/master/gcc/config/i386/i386.cc</a><br>5.NASM汇编器：<a href="https://github.com/netwide-assembler/nasm" target="_blank" rel="noopener">https://github.com/netwide-assembler/nasm</a><br>6.libyuv：<a href="https://github.com/sayrer/libyuv/blob/master/source/scale_win.cc" target="_blank" rel="noopener">https://github.com/sayrer/libyuv/blob/master/source/scale_win.cc</a> libyuv是google 开源的用于实现对各种yuv数据之间的转换包括裁剪、缩放、旋转，以及yuv和rgb 之间的转换，底层有一部分代码是基于汇编实现的，大大提高了转换速度。<br>libyuv被广泛用于 音视频SDK中。</p>
<p>编程就像修高楼，只有夯实基础，万丈高楼才能平地起，这样的大楼自然经得住风吹雨打！</p>
        
            <div class="readmore">
                <a href="/C++从入门到实践，你不得不知道的事一：C++函数的一些底层细节/" class="flat-box">
                    <i class="fas fa-book-open fa-fw" aria-hidden="true"></i>
                    阅读全文
                </a>
            </div>
        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/C/"><i class="fas fa-hashtag fa-fw"></i>C++</a>
                
                    <a href="/tags/C-深入浅出系列/"><i class="fas fa-hashtag fa-fw"></i>C++深入浅出系列</a>
                
            </div>
        
    </section>
</article>

            </div>
          
        
          
            <div class="post-wrapper">
              <article class="post reveal ">
    
<section class="meta">
  
  
  <div class="meta" id="header-meta">
    
      <h2 class="title">
          <a href="/C++指针详解/">
              
                  C++指针详解
              
          </a>
      </h2>
    

    <div class="new-meta-box">
      
        <div class="new-meta-item author">
          <a href="https://calm2012.github.io/calm2012.github.io">
            <i class="fas fa-user" aria-hidden="true"></i>
            calm2012
          </a>
        </div>
      
      
        <div class="new-meta-item date">
          <a class="notlink">
            <i class="fas fa-clock" aria-hidden="true"></i>
            2021-08-25 星期三
          </a>
        </div>
      
      
        
          
          <div class="new-meta-item category">
            <a href="/categories/C/C-深入浅出系列/">
              <i class="fas fa-folder-open" aria-hidden="true"></i>
              C++&nbsp;/&nbsp;C++深入浅出系列
            </a>
          </div>
        
      
      
      
    </div>
    <hr>
  </div>
</section>

    <section class="article typo">
        <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a = <span class="number">111</span>;</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">222</span>;</span><br><span class="line"><span class="keyword">int</span> c = <span class="number">333</span>;</span><br><span class="line"><span class="keyword">int</span>* pp1[<span class="number">3</span>]&#123;&amp;a, &amp;b, &amp;c&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">decltype</span>(pp1)* Fun1(<span class="keyword">int</span> nNum);</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> <span class="keyword">int_array_t</span>[<span class="number">3</span>];</span><br><span class="line">typedef int (*int_array_ptr_t)[3];</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">int</span> <span class="params">(*int_array_ptr_t2[<span class="number">3</span>])</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int_array_t</span> obj = &#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;;</span><br><span class="line"><span class="keyword">int_array_ptr_t</span> p_obj;</span><br><span class="line">int_array_ptr_t2* p_obj2 = &amp;pp1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int_array_t</span>* fun0(<span class="keyword">int</span> n);</span><br><span class="line"><span class="keyword">int_array_ptr_t</span> fun1(<span class="keyword">int</span> n);</span><br><span class="line"><span class="function">int_array_ptr_t2* <span class="title">fun3</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. 普通指针</span></span><br><span class="line">    <span class="keyword">int</span> nNum = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">int</span>* p0 = &amp;nNum;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *p0 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> p1[<span class="number">3</span>]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 由n个int型指针组成的数组;数组的元素是指针类型</span></span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> c = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> *p2[<span class="number">3</span>]&#123;&amp;a, &amp;b, &amp;c&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::defaultfloat;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::hex &lt;&lt; <span class="built_in">std</span>::showbase;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"&amp;a:\t"</span> &lt;&lt; (<span class="keyword">size_t</span>)&amp;a &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"p3[0]:\t"</span> &lt;&lt; (<span class="keyword">size_t</span>)p2[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"&amp;b:\t"</span> &lt;&lt; (<span class="keyword">size_t</span>)&amp;b &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"p3[1]:\t"</span> &lt;&lt; (<span class="keyword">size_t</span>)p2[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"&amp;c:\t"</span> &lt;&lt; (<span class="keyword">size_t</span>)&amp;c &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"p3[2]:\t"</span> &lt;&lt; (<span class="keyword">size_t</span>)p2[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 一个指向由n个元素的数组的指针，数组元素的值为int型</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::dec;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>(*p3)[<span class="number">3</span>] = &amp;p1;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (*p3)[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (*p3)[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (*p3)[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. 指向int型指针的指针</span></span><br><span class="line">    <span class="keyword">int</span>** p4 = &amp;p0;</span><br><span class="line">    **p4 = <span class="number">123456</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; **p4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. 函数指针</span></span><br><span class="line">    <span class="keyword">int</span> (*p5)(<span class="keyword">int</span>) = show;                  <span class="comment">// 一个指向有一个整型参数, 返回值为整型的函数的指针</span></span><br><span class="line">    p5(<span class="number">1</span>);</span><br><span class="line">    (*p5)(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. 带一个int型参数返回值为指向n个int型指针元素的数组的函数</span></span><br><span class="line">    <span class="keyword">int</span>*(*p6(<span class="keyword">int</span>))[<span class="number">3</span>];                      <span class="comment">// p是一个函数, 函数的参数为int型;函数的返回值为指针;指针指向是一个数组;数组的元素为指针;数组的元素指针为int型指针</span></span><br><span class="line">    <span class="keyword">decltype</span>(pp1)* pPP1 = Fun1(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *((<span class="keyword">int</span>*)((*pPP1)[<span class="number">0</span>])) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *((<span class="keyword">int</span>*)((*pPP1)[<span class="number">1</span>])) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *((<span class="keyword">int</span>*)((*pPP1)[<span class="number">2</span>])) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    int_array_ptr_t2* pAray3 = fun3(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *((<span class="keyword">int</span>*)((*pAray3)[<span class="number">0</span>])) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *((<span class="keyword">int</span>*)((*pAray3)[<span class="number">1</span>])) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *((<span class="keyword">int</span>*)((*pAray3)[<span class="number">2</span>])) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// int (*func)(int *p, int (*f)(int*));</span></span><br><span class="line">    <span class="comment">// 7. func是一个指向函数的指针，这类函数具有int *和int (*)(int*)这样的形参，返回值为int类型</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// int (*func[3])(int);</span></span><br><span class="line">    <span class="comment">// 8. func数组的元素是函数类型的指针，它所指向的函数具有int类型的形参，返回值类型为int</span></span><br><span class="line">    <span class="keyword">int</span> (*func[<span class="number">3</span>])(<span class="keyword">int</span>) = &#123;show, show, show&#125;;</span><br><span class="line"></span><br><span class="line">    func[<span class="number">0</span>](<span class="number">0</span>);</span><br><span class="line">    func[<span class="number">1</span>](<span class="number">0</span>);</span><br><span class="line">    func[<span class="number">2</span>](<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// int (*(*func)[3])(int);</span></span><br><span class="line">    <span class="comment">// 9. func是一个指向数组的指针，这个数组的元素是函数指针，这些指针指向具有int形参，返回值为int类型的函数。</span></span><br><span class="line">    <span class="keyword">int</span> (*(*func9)[<span class="number">3</span>])(<span class="keyword">int</span>) = &amp;func;</span><br><span class="line">    (*func9)[<span class="number">0</span>](<span class="number">0</span>);</span><br><span class="line">    (*func9)[<span class="number">1</span>](<span class="number">0</span>);</span><br><span class="line">    (*func9)[<span class="number">2</span>](<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// int (*(*func)(int))[3];</span></span><br><span class="line">    <span class="comment">// 10. func是一个函数指针，这类函数具有int类型的形参，返回值是指向数组的指针，所指向的数组的元素是具有3个int元素的数组</span></span><br><span class="line">    <span class="keyword">int</span>(*(*func10)(<span class="keyword">int</span>))[<span class="number">3</span>] = fun1;</span><br><span class="line">    <span class="keyword">int_array_ptr_t</span> p10 = func10(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (*p10)[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (*p10)[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (*p10)[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">show</span><span class="params">(<span class="keyword">int</span>)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"show function."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">decltype</span>(pp1)* Fun1(<span class="keyword">int</span> nNum) &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;pp1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int_array_t</span>* fun0(<span class="keyword">int</span> n) &#123;</span><br><span class="line">    p_obj = &amp;obj;</span><br><span class="line">    <span class="keyword">return</span> &amp;obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int_array_ptr_t</span> fun1(<span class="keyword">int</span> n) &#123;</span><br><span class="line">    p_obj = fun0(n);</span><br><span class="line">    <span class="keyword">return</span> p_obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">int_array_ptr_t2* <span class="title">fun3</span><span class="params">(<span class="keyword">int</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p_obj2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
            <div class="readmore">
                <a href="/C++指针详解/" class="flat-box">
                    <i class="fas fa-book-open fa-fw" aria-hidden="true"></i>
                    阅读全文
                </a>
            </div>
        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/C/"><i class="fas fa-hashtag fa-fw"></i>C++</a>
                
                    <a href="/tags/C-深入浅出系列/"><i class="fas fa-hashtag fa-fw"></i>C++深入浅出系列</a>
                
            </div>
        
    </section>
</article>

            </div>
          
        
          
            <div class="post-wrapper">
              <article class="post reveal ">
    
<section class="meta">
  
  
  <div class="meta" id="header-meta">
    
      <h2 class="title">
          <a href="/C++深入浅出之：C++虚表(一)/">
              
                  C++深入浅出之：C++虚表(一)
              
          </a>
      </h2>
    

    <div class="new-meta-box">
      
        <div class="new-meta-item author">
          <a href="https://calm2012.github.io/calm2012.github.io">
            <i class="fas fa-user" aria-hidden="true"></i>
            calm2012
          </a>
        </div>
      
      
        <div class="new-meta-item date">
          <a class="notlink">
            <i class="fas fa-clock" aria-hidden="true"></i>
            2021-02-07 星期日
          </a>
        </div>
      
      
        
          
          <div class="new-meta-item category">
            <a href="/categories/C/C-深入浅出系列/">
              <i class="fas fa-folder-open" aria-hidden="true"></i>
              C++&nbsp;/&nbsp;C++深入浅出系列
            </a>
          </div>
        
      
      
      
    </div>
    <hr>
  </div>
</section>

    <section class="article typo">
        <figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">实验环境:</span> <span class="string">windows10</span> <span class="string">x64</span>  <span class="string">VS2019</span></span><br><span class="line"><span class="string">我们来分析最基本的</span> <span class="string">单继承</span></span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span></span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Base show.\n"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">virtual</span> ~Base() &#123;&#125;</span><br><span class="line">  <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTest</span> :</span> <span class="keyword">public</span> Base &#123;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"CTest show.\n"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Base b;</span><br><span class="line">  b.show();</span><br><span class="line"></span><br><span class="line">  Base* pTest = <span class="keyword">new</span> CTest();</span><br><span class="line"></span><br><span class="line">  pTest-&gt;show();</span><br><span class="line">  <span class="keyword">delete</span> pTest;</span><br><span class="line">  pTest = <span class="literal">nullptr</span>; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://s3.ax1x.com/2021/02/07/yN4SM9.png"><br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span><span class="string">可以看到pTest的地址是0x0021ab4c，也是导入表的地址</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://s3.ax1x.com/2021/02/07/yN4FIK.png"><br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.</span><span class="string">导入第一个地址：0x00211573，即</span> <span class="attr">CTest::show的地址</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://s3.ax1x.com/2021/02/07/yN4APO.png"><br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3.</span><span class="string">切换到汇编验证一下</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://s3.ax1x.com/2021/02/07/yN4VRe.png"><br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4.</span><span class="string">这里eax就是CTest::show的地址，和</span> <span class="string">上边通过导入表看到地址是一样的，都是0x00211573，也就演示了虚表中，</span></span><br><span class="line"><span class="string">成员的存放方式</span></span><br></pre></td></tr></table></figure></p>
        
            <div class="readmore">
                <a href="/C++深入浅出之：C++虚表(一)/" class="flat-box">
                    <i class="fas fa-book-open fa-fw" aria-hidden="true"></i>
                    阅读全文
                </a>
            </div>
        

        
            <div class="full-width auto-padding tags">
                
                    <a href="/tags/C/"><i class="fas fa-hashtag fa-fw"></i>C++</a>
                
                    <a href="/tags/C-深入浅出系列/"><i class="fas fa-hashtag fa-fw"></i>C++深入浅出系列</a>
                
            </div>
        
    </section>
</article>

            </div>
          
        
      

  </section>






  

  <!-- 根据主题中的设置决定是否在archive中针对摘要部分的MathJax公式加载mathjax.js文件 -->
  

  



        </div>
        <aside class='l_side'>
            
  
  
    
      
      
        <section class="author">
  <div class="content pure">
    
      <div class="avatar">
        <img class="avatar" src="https://s4.ax1x.com/2022/03/03/bJYa79.jpg">
      </div>
    
    
      <div class="text">
        
        
        
          <p><span id="jinrishici-sentence">柳暗花明又一村</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
  </div>
</section>

      
    
  
    
      
      
        <section class="plain">
  
<header class="pure">
  <div><i class="fas fa-bullhorn fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;注意啦～</div>
  
    <a class="rightBtn" target="_blank" rel="external nofollow noopener noreferrer" href="https://xaoxuu.com/wiki/material-x/" title="https://xaoxuu.com/wiki/material-x/">
    <i class="fas fa-question-circle fa-fw"></i></a>
  
</header>

  <div class="content pure">
    <p>欢迎访问程序员小站,喜欢的朋友可以安利给身边的朋友哦～ <br> QQ群:&emsp;&emsp;&emsp;&nbsp;&nbsp;<a href="http://shang.qq.com/wpa/qunwpa?idkey=38fbc1431dcb54c10cf7ef249808bad95b939883031ec289660b8d6c4bd4cb27">103197177</a> <br>今日头条ID:&emsp;<a href="https://www.toutiao.com/c/user/5924607123/">光影星辰彩虹之南</a></p>

  </div>
</section>

      
    
  
    
      
      
        
  <section class="category">
    
<header class="pure">
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;所有分类</div>
  
</header>

    <div class="content pure">
      <ul class="entry">
        
          <li><a class="flat-box" title="/categories/C/" href="/categories/C/"><div class="name">C++</div><div class="badge">(3)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/C/C-深入浅出之：C-函数的一些底层细节/" href="/categories/C/C-深入浅出之：C-函数的一些底层细节/"><div class="name">C++深入浅出之：C++函数的一些底层细节</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/C/C-深入浅出系列/" href="/categories/C/C-深入浅出系列/"><div class="name">C++深入浅出系列</div><div class="badge">(2)</div></a></li>
        
          <li><a class="flat-box" title="/categories/MacOS/" href="/categories/MacOS/"><div class="name">MacOS</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/MacOS/CEF/" href="/categories/MacOS/CEF/"><div class="name">CEF</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/QT/" href="/categories/QT/"><div class="name">QT</div><div class="badge">(2)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/QT/QT/" href="/categories/QT/QT/"><div class="name">QT</div><div class="badge">(2)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Resharper/" href="/categories/Resharper/"><div class="name">Resharper</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Resharper/Resharper/" href="/categories/Resharper/Resharper/"><div class="name">Resharper</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Ruby/" href="/categories/Ruby/"><div class="name">Ruby</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Ruby/Ruby/" href="/categories/Ruby/Ruby/"><div class="name">Ruby</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Windows/" href="/categories/Windows/"><div class="name">Windows</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/Windows/UAC实现原理/" href="/categories/Windows/UAC实现原理/"><div class="name">UAC实现原理</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/cmake/" href="/categories/cmake/"><div class="name">cmake</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/cmake/cmake/" href="/categories/cmake/cmake/"><div class="name">cmake</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/linux/" href="/categories/linux/"><div class="name">linux</div><div class="badge">(49)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/linux/Linux编译环境设置/" href="/categories/linux/Linux编译环境设置/"><div class="name">Linux编译环境设置</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/linux/Linux软件安装/" href="/categories/linux/Linux软件安装/"><div class="name">Linux软件安装</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/linux/Linux高性能服务器编程/" href="/categories/linux/Linux高性能服务器编程/"><div class="name">Linux高性能服务器编程</div><div class="badge">(42)</div></a></li>
        
          <li><a class="flat-box" title="/categories/系统设置/" href="/categories/系统设置/"><div class="name">系统设置</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/系统设置/Win10/" href="/categories/系统设置/Win10/"><div class="name">Win10</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/编译错误/" href="/categories/编译错误/"><div class="name">编译错误</div><div class="badge">(2)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/编译错误/VC/" href="/categories/编译错误/VC/"><div class="name">VC</div><div class="badge">(2)</div></a></li>
        
          <li><a class="flat-box" title="/categories/自动化测试/" href="/categories/自动化测试/"><div class="name">自动化测试</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/自动化测试/GoogleTest/" href="/categories/自动化测试/GoogleTest/"><div class="name">GoogleTest</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/跨平台/" href="/categories/跨平台/"><div class="name">跨平台</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/软件设置/" href="/categories/软件设置/"><div class="name">软件设置</div><div class="badge">(4)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/软件设置/Everything/" href="/categories/软件设置/Everything/"><div class="name">Everything</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/软件设置/VM/" href="/categories/软件设置/VM/"><div class="name">VM</div><div class="badge">(1)</div></a></li>
        
          <li><a class="flat-box child" title="/categories/软件设置/VS/" href="/categories/软件设置/VS/"><div class="name">VS</div><div class="badge">(1)</div></a></li>
        
      </ul>
    </div>
  </section>


      
    
  
    
      
      
        
  <section class="tagcloud">
    
<header class="pure">
  <div><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
</header>

    <div class="content pure">
      <a href="/tags/C/" style="font-size: 18px; color: #7e7e7e">C++</a> <a href="/tags/C-深入浅出系列/" style="font-size: 18px; color: #7e7e7e">C++深入浅出系列</a> <a href="/tags/CEF/" style="font-size: 14px; color: #999">CEF</a> <a href="/tags/Everything/" style="font-size: 14px; color: #999">Everything</a> <a href="/tags/GoogleTest/" style="font-size: 14px; color: #999">GoogleTest</a> <a href="/tags/Linux编译环境设置/" style="font-size: 14px; color: #999">Linux编译环境设置</a> <a href="/tags/Linux软件安装/" style="font-size: 14px; color: #999">Linux软件安装</a> <a href="/tags/Linux高性能服务器编程/" style="font-size: 22px; color: #636363">Linux高性能服务器编程</a> <a href="/tags/MacOS/" style="font-size: 14px; color: #999">MacOS</a> <a href="/tags/QT/" style="font-size: 16px; color: #8b8b8b">QT</a> <a href="/tags/Resharper/" style="font-size: 14px; color: #999">Resharper</a> <a href="/tags/Ruby/" style="font-size: 14px; color: #999">Ruby</a> <a href="/tags/UAC实现原理/" style="font-size: 14px; color: #999">UAC实现原理</a> <a href="/tags/VC/" style="font-size: 16px; color: #8b8b8b">VC</a> <a href="/tags/VM/" style="font-size: 14px; color: #999">VM</a> <a href="/tags/VS/" style="font-size: 14px; color: #999">VS</a> <a href="/tags/Win10/" style="font-size: 14px; color: #999">Win10</a> <a href="/tags/Windows/" style="font-size: 14px; color: #999">Windows</a> <a href="/tags/cmake/" style="font-size: 14px; color: #999">cmake</a> <a href="/tags/linux/" style="font-size: 24px; color: #555">linux</a> <a href="/tags/系统设置/" style="font-size: 14px; color: #999">系统设置</a> <a href="/tags/编译错误/" style="font-size: 16px; color: #8b8b8b">编译错误</a> <a href="/tags/自动化测试/" style="font-size: 14px; color: #999">自动化测试</a> <a href="/tags/跨平台/" style="font-size: 14px; color: #999">跨平台</a> <a href="/tags/软件设置/" style="font-size: 20px; color: #707070">软件设置</a>
    </div>
  </section>


      
    
  
    
      
      
        

      
    
  
    
      
      
        



      
    
  
    
      
      
        

      
    
  


        </aside>
        <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
    </div>
    <footer id="footer" class="clearfix">
  
  
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>本站使用 <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a> 作为主题，总访问量为 <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span> 次。
  </div>
</footer>

    <script>setLoadingBarProgress(80);</script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>


  
    <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
    <script type="text/javascript">
      $(function() {
        const $reveal = $('.reveal');
    		if ($reveal.length === 0) return;
    		const sr = ScrollReveal({ distance: 0 });
    		sr.reveal('.reveal');
      });
    </script>
  
  
    <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
    <script type="text/javascript">
      $(function() {
        Waves.attach('.flat-btn', ['waves-button']);
        Waves.attach('.float-btn', ['waves-button', 'waves-float']);
        Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
        Waves.attach('.flat-box', ['waves-block']);
        Waves.attach('.float-box', ['waves-block', 'waves-float']);
        Waves.attach('.waves-image');
        Waves.init();
      });
    </script>
  
  
    <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>
  
  
  

  
  
  
  
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    
      
        <script src="https://cdn.jsdelivr.net/gh/xaoxuu/volantis@1/js/volantis.min.js"></script>
      
    
    <script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = 'nick,mail,link'.split(',').filter(function(item){
      return GUEST_INFO.indexOf(item) > -1
    });
    var notify = 'false' == true;
    var verify = 'false' == true;
    var valine = new Valine();
    valine.init({
      el: '#valine_container',
      notify: notify,
      verify: verify,
      guest_info: guest_info,
      
      appId: "AHP3eJnwKM7kHv6e0Rwre6qD-gzGzoHsz",
      appKey: "A2poayI0o1E4qSbUgKidPw2Q",
      placeholder: "快来评论吧~",
      pageSize:'10',
      avatar:'mp',
      lang:'zh-cn',
      highlight:''
    })
    </script>
  

  
    <script src="/js/app.js"></script>
<script src="/js/search.js"></script>
  






    <script>setLoadingBarProgress(100);</script>
</body>
</html>
